<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>To Do App</title>
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <style>
    .disabled {
      text-decoration: line-through;
    }
  </style>
  <script>
  alert("javascript");
    window.onload = function(){
      alert("loaded");

      // bring list in from localStorage if applicable
      
      var listArr = JSON.parse(localStorage.getItem("currentList"));
      var form = document.querySelector("form");
      var list = document.querySelector("ul");
      var span = document.createElement("span");

      if(listArr.length > 0) {
        for (var i=0; i<listArr.length; i++) {
          var oldToDo = document.createElement("li");
          oldToDo.innerText = listArr[i].todo;
          oldToDo.setAttribute("class", "list-group-item");
          oldToDo.setAttribute("ID", i);
          if(listArr[i].done) {
            oldToDo.setAttribute("class", "list-group-item disabled");
          } else {
            oldToDo.setAttribute("class", "list-group-item")
          }
          list.appendChild(oldToDo);
        }
      } else {
        listArr = [];
      }

      var counter = listArr.length;

      // add a new To Do item

      form.addEventListener("submit", function(event){
        var newToDo = document.createElement("li");
        newToDo.innerText = form.elements[0].value;
        newToDo.setAttribute("class", "list-group-item");
        newToDo.setAttribute("done", "false");
        newToDo.setAttribute("ID", counter);
        counter += 1;
        if (newToDo.innerText.length === 0) {
          form.preventDefault();
        } else {
          list.appendChild(newToDo);
          listArr.push({
            todo: newToDo.innerText,
            done: false
          });
          localStorage.setItem("currentList", JSON.stringify(listArr));
          form.reset();
        }
      });

      // mark an item as completed

      list.addEventListener("click", function(event){
        if (event.target.getAttribute("class") === "list-group-item") {
          event.target.setAttribute("class", "list-group-item disabled");
          for (var i=0; i<listArr.length; i++) {
            if(listArr[i].todo === event.target.innerText) {
              listArr[i].done = true;
            }
          }
        } else {
          event.target.setAttribute("class", "list-group-item");
          for (var i=0; i<listArr.length; i++) {
            if(listArr[i].todo === event.target.innerText) {
              listArr[i].done = false;
            }
          }
        }
        localStorage.setItem("currentList", JSON.stringify(listArr));
      });

      // remove an item

      list.addEventListener("mouseover", function(event){
        event.target.appendChild(span);
        span.setAttribute("class", "glyphicon glyphicon-remove pull-right");
      });

      span.addEventListener("click", function(event){
        event.target.parentNode.remove();
        var id = event.target.parentNode.getAttribute("ID");
        listArr.splice(id,1);
        localStorage.setItem("currentList", JSON.stringify(listArr));
      });

    };
  </script>
</head>
<body>
    <h1 class="header text-center">To Do</h1>
    <section class="container">
      <form class="form" action="#">
        <div class="form-group">
            <label for="todo">What do you have to do today?</label>
            <input type="text" class="form-control" id="todo" placeholder="Buy milk">
        </div>
        <button type="submit" class="btn btn-default pull-right">Submit
        </button>
      </form>
    </section>
    <hr>
    <section class="container class-group">
      <ul class="col-xs-12">
      </ul>
    </section>
</body>
</html>